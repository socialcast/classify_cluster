#!/usr/bin/env ruby

require "classify_cluster"
require "classify_cluster/version"
require "commander/import"
require 'yaml'

program :name, "Classify Cluster"
program :version, ClassifyCluster::VERSION
program :description, 'Generates configurations for different aspects of the cluster based off of one configuration.'
default_command :puppet

command :puppet do |c|
  c.syntax = 'classify puppet <clustername> <hostname> [options]'
  c.description = 'Returns on STDOUT YAML dump of the clusters puppet config'
  c.option '--config STRING', String, 'Location to config file.'
  c.action do |args, options|
    options.default :config => ClassifyCluster::Base.default_config_file, :export => './'
    cluster = args[0]
    ClassifyCluster::Writers::Puppet.export(options[:export], :cluster => cluster, :config_file => options.config) && say "Success!"
  end
end